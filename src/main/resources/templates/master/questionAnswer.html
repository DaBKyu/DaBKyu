<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문의 답변 페이지</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" >
    <link rel="stylesheet" href="../static/css/master.css" th:href="@{/css/master.css}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" ></script>
</head>
<body>

    <!-- 네비게이션 바 -->
    <div th:insert="~{layout/masterNav :: master-nav}"></div>

<div class="container mt-5">
    <h2>문의 답변 페이지</h2>

    <!-- 문의 정보 표시 -->
    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">문의 제목: <span th:text="${question.queTitle}"></span></h5>
            <p class="card-text">문의 내용:</p>
            <p th:text="${question.queContent}"></p>
            <p class="card-text"><small class="text-muted">작성자: <span th:text="${question.email.email}"></span></small></p>
            <p class="card-text"><small class="text-muted">작성일: <span th:text="${#temporals.format(question.queDate, 'yyyy-MM-dd HH:mm')}"></span></small></p>
        </div>
    </div>

    <!-- 첨부  -->
    <div th:if="${#lists.size(questionFiles) > 0}">
        <h5>첨부 파일</h5>
        <ul>
            <li th:each="file : ${questionFiles}">
                <a th:href="@{'/q_img/' + ${file.filePath}}" target="_blank" th:text="${file.fileName}"></a>
            </li>
        </ul>
    </div>

    <!-- 답변 작성 폼 -->
    <form action="/master/submitAnswer" method="post">
        <!-- Hidden input for Question ID -->
        <input type="hidden" name="id" th:value="${question.id}">

        <!-- 답변 입력란 -->
        <div class="mb-3">
            <label for="answerContent" class="form-label">답변 내용:</label>
            <textarea class="form-control" id="answerContent" name="answerContent" rows="5"></textarea>
        </div>

        <!-- 제출 버튼 -->
        <button type="submit" class="btn btn-primary" onclick="/master/question/reply/{queSeqno}">답변 제출</button>

        <!-- 작성중 페이지로 돌아가기 버튼 -->
        <button type="button" class="btn btn-secondary" onclick='window.history.back()'>돌아가기</button>
    </form>

</div>
<script>
    function submitReply() {
  const content = document.querySelector('textarea[name="content"]').value;
  const kind = 'I'; // 등록 모드 (수정 시 'U'로 변경)
  
  fetch('/master/question/reply/1', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ content, kind })
  })
  .then(response => response.json())
  .then(data => alert(data.message))
  .catch(error => console.error('Error:', error));
}
</script>

</body>
</html>